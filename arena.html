<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Smasher.ET - Smash or Get Smashed!</title>
<link rel="icon" href = "https://i.ibb.co/pPWYF9D/Screenshot-2022-11-13-8-58-50-PM-removebg-preview.png"  type="image/gif">

    <style>
    
@import url('https://fonts.googleapis.com/css2?family=Ubuntu:wght@500&display=swap');
/* 
@font-face {
  font-family: 'Ubuntu';
  font-style: normal;
  font-weight: 500;
  src: url('/ubuntu-v20-latin-500.eot');
  src: local(''),
       url('/ubuntu-v20-latin-500.eot?#iefix') format('embedded-opentype'),
       url('/ubuntu-v20-latin-500.woff2') format('woff2'),
       url('/ubuntu-v20-latin-500.woff') format('woff'),
       url('/ubuntu-v20-latin-500.ttf') format('truetype'),
       url('/ubuntu-v20-latin-500.svg#Ubuntu') format('svg');
} */

@import url('https://fonts.googleapis.com/css2?family=Ubuntu:wght@500&display=swap');
@keyframes rotate{
  from{
    width:100px;
  }
  to{
    width:150px;
  }
}
*{
        font-family:'Ubuntu', sans-serif;
      }
      body {
        width:  100%;
        height: 100%;
        margin: 0;
        overflow:hidden;
      }

      #usernameInput{
        height:4em;
        font-size:3em;
      }
      #usernameInput:focus{
        outline:none;
      }
      .player{
        width:50px;
        height:50px;
        background-color: blue;
        text-align:center;
        font-weight:bold;
        position:absolute;
        color:#ffffff;
      }
     

      #chat{
        position:absolute;
        left:0;
        bottom:0;
        margin:0;
        font-size:2rem;
        
      }
      #chat:focus{
        outline:none;
      }
      #canvas {
        position:absolute;
        width:100vw;
        height:100vh;
      }
      #zoomOutButton {
        position:absolute;
        top:0;
        left:0;
        font-size:2em;
      }
      #zoomOutButton:hover{
        cursor:pointer;
      }
      .cursor-pointer:hover{
        cursor:pointer;
      }
    
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <link rel="stylesheet" href="bootstrap.min.css">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
 
    <script src = "https://mhsmill.com/loadingPage.js?Version=1.7"></script>
    <div id = "begin" class="d-flex align-items-center top-0 position-fixed h-100 w-100" style="z-index:100; background-color:rgba(0,0,0,.5);">
      <div id="credHolder"class="text-center bg-dark d-flex align-items-center border border-5 border-danger" style="width:400px; height:400px;position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);">
     
          
         <div class="container-fluid text-center">
          <h1 class="text-white mb-4" id="logText">Login</h1>
          <input placeholder="Username" id="usernameValue" type="username"> 
          <br>
          <br>
          <input placeholder="Password" id="passwordValue" type="password">
          <button class="btn btn-success fs-3 text-white mt-4" style="width:200px;" onclick="login()" id="logButton">Login</button>

         </div>
         </div>
      <div class="d-flex align-items-center mx-3 my-3" style="position:absolute; right:0; top:0;"><img src="https://i.ibb.co/pPWYF9D/Screenshot-2022-11-13-8-58-50-PM-removebg-preview.png" width="50" class="mx-1"><span id="profileName" class="text-white fs-2">Guest</span></div>
    <div class="text-center container-fluid ">
      <h1 class="display-1 text-white">SMASHER</h1>
      <input id = "usernameInput" placeholder="Enter Your Username" maxLength="13" class="text-center">

      <br>
      <div id="loginHolder">
        <div id = "noAccBox">
          <button class="btn btn-info px-5 fs-2 my-3 text-white" style="width:300px;" onclick="startcred('login')">Login</button>
        <br>
        <button class="btn btn-danger px-5 fs-2" style="width:300px;" onclick="startcred('signup')">Sign Up</button>
        </div>
        <div id="logOutBox">
          <button class="btn btn-secondary px-5 fs-2 my-3" style="width:300px;" onclick="logoutACC()">Logout</button>
  
        </div>

      </div>


      <p class="bottom-0 position-absolute text-white bg-dark p-1 px-3 ms-2">Players are not shown</p>
    </div>

    <div class="bg-dark p-5 pt-4 border border-5 border-light rounded" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);"  id="classHolder">
      <h1 class="text-white text-center mb-4">Pick a class</h1>
      <div class="mx-3 border border-warning border-5 d-flex align-items-center cursor-pointer" onclick = "rest('swordsman')" style="background-color:#2d0043; width:200px; height:200px; float:left;">
        <div class="container-fluid text-center">
          <img src="https://i.ibb.co/KFjKhpm/swordsman.png" width="150px">
          <p class="bottom-0 position-absolute text-light" style="transform:translate(20%,-30%);">The Swordsman</p>
        </div>
      </div>
      <div class="mx-3 border border-warning border-5 d-flex align-items-center" onclick = "rest('sniper')" style="background-color:#2d0043; width:200px; height:200px; " id="sniperHolder">
        <div class="container-fluid text-center">
          <img src="https://www.pngplay.com/wp-content/uploads/8/Padlock-Background-PNG-Image.png" width="150px" id="sniperImg">
          <p class="bottom-0 position-absolute text-light" style="transform:translate(25%,-30%);"  id="sniperText">Login to Unlock</p>
        </div>
      </div>
    </div>
    
    </div>
    <canvas id ="canvas"></canvas>
    <button id = "zoomOutButton" onclick = "kick(document.getElementById('chat').value)">Kick</button>
    <input id="chat" placeholder="Press '/' to chat!" maxLength = "30" class="position-fixed my-3 mx-4 border border-5 border-dark">

   <div id="start">
    
    <div class="container-fluid w-100 mt-2 text-center position-fixed" id = "stats">
      <p class="display-6 fw-bold text-white bg-dark d-inline-block px-5 py-2 border border-5" id = "stamina">Stamina: <span class="badge bg-success" id="stamBadge">50</span></p>
      <p class="display-6 fw-bold text-white bg-dark d-inline-block px-5 py-2 border border-5" id = "cooldown"><span class="badge bg-secondary" id="atkCooldownBadge">Reloading...</span></p>

    </div>
   </div>
   
      
    
<script src="/socket.io/socket.io.js"></script>

    <script>


      var beginDiv = document.getElementById('begin');
      var classHolder = document.getElementById('classHolder');
      beginDiv.removeChild(classHolder);
       animate();
      var startDiv = document.getElementById('start');
      
      document.body.removeChild(startDiv);
      function setCookie(cname, cvalue) {
  document.cookie = cname + "=" + cvalue + ";";
}
var credHolder = document.getElementById('credHolder');
beginDiv.removeChild(credHolder);
function startcred(type){
  beginDiv.appendChild(credHolder);
  if(type == "login"){
    document.getElementById('logText').innerHTML = "Login";
    document.getElementById('logButton').innerHTML = "Login";
    document.getElementById('logButton').setAttribute("onclick", "login()");
  } else if(type == "signup"){
    document.getElementById('logText').innerHTML = "Sign Up";
    document.getElementById('logButton').innerHTML = "Sign Up";
    document.getElementById('logButton').setAttribute("onclick", "signUp()");
  }
}
function getCookie(cname) {
  let name = cname + "=";
  let ca = document.cookie.split(';');
  for(let i = 0; i < ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}

      function checkCookie() {
  var tusername = getCookie("username");
  if (tusername != "") {
   document.getElementById('usernameInput').value = tusername;
  }
}

checkCookie();
      var spawned = false;
      var started = false;
      var socket = io();
      var players = new Object({});
      var username="booga";
      var canvas = document.getElementById('canvas');
      var chatInput = document.getElementById('chat');
      document.body.removeChild(chatInput);
      var kickButton = document.getElementById('zoomOutButton');
      function rest(type){
        if(type == "sniper" && playerData.length == 0){

        } else {
          document.body.appendChild(startDiv);
        setCookie("username", username);
fetch('/userpost', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({"user" : username})})
.then(function(response) {
      if(response.ok) return response.json();
      throw new Error('Request failed.');
    });
if(type == "swordsman"){
  document.getElementById("stats").removeChild(document.getElementById("cooldown"));
} else if(type == "sniper"){
  document.getElementById("stats").removeChild(document.getElementById("stamina"));
}
            
          document.body.removeChild(document.getElementById('begin'));
          document.body.appendChild(chatInput);
          socket.emit('spawn player', [username, type]);
          beginDiv.removeChild(classHolder);
        }

        
          }
      
      document.body.removeChild(kickButton);
      function kick(user){
        socket.emit('update', user, "dc<prog>dc</prog>dcpassword:password:dc");
      }
      window.addEventListener('keydown', event =>{
      
        if(event.key == "Enter" && !started){
          
          username = document.getElementById('usernameInput').value;
          if(username == ""){
            alert("you need to enter a name");
          } else {
            
           
            if(beginDiv.contains(credHolder)){
              if(document.getElementById('logText').innerHTML =="Sign Up"){
                signUp();
              } else if(document.getElementById('logText').innerHTML =="Login"){
                login();
              }
            } else {
              beginDiv.appendChild(classHolder);
            if(playerData.length != 0){
              document.getElementById('sniperText').innerHTML = "The Sniper";
              document.getElementById('sniperText').setAttribute("style","transform:translate(55%,-30%);");
              document.getElementById('sniperHolder').classList.add("cursor-pointer");
              document.getElementById('sniperImg').setAttribute("src", "https://i.ibb.co/0n7wzJP/sniper.png");
            }
            }
          
        }
      }
        if (event.key == "/"){
          chatInput.focus();
          
        }
        if (event.key == "Enter" && document.activeElement == chatInput && chatInput.value !== ""){
          socket.emit('update', username, chatInput.value);
          chatInput.value = "";
          chatInput.blur();
          canvas.focus();
        }
        if(chatInput !== document.activeElement){
          if (event.key == "d" || event.key == "D" || event.keyCode == "39"){
            movement.right = true;
        } else if (event.key == "a" || event.key == "A" || event.keyCode == "37"){
            movement.left = true;
        }
        if (event.key == "w" || event.key == "W" || event.keyCode == "38"){
            movement.up = true;
        } else if (event.key == "s" || event.key == "S" || event.keyCode == "40"){
            movement.down = true;
        }
        if(event.key == " "){
          movement.atk = true;
        }
        }
        
    })
    //.focus()
    window.addEventListener('keyup', event=>{
        if (event.key == "d" || event.key == "D" || event.keyCode == "39"){
            movement.right = false;
        } else if (event.key == "a" || event.key == "A" || event.keyCode == "37"){
            movement.left = false;
        }
        if (event.key == "w" || event.key == "W" || event.keyCode == "38"){
            movement.up = false;
        } else if (event.key == "s" || event.key == "S" || event.keyCode == "40"){
            movement.down = false;
        }
        if (event.key == " "){
          movement.atk = false;
        }

    })
      var ctx = canvas.getContext("2d");
      var gravity = 1;
      var usernameList = [];
      var prevX;
      var prevY;
          class Element {
    constructor({x,y, text = "",width = 200,height=200,color="red", type="element",fakie = false, opacity = 1}){
        this.position = {
            x:x,
            y:y,
        }
        this.original = {
            x:x,
            y:y,
        }
        this.fakie =fakie;
        this.width = width;
        this.height = height;
        this.color = color;
        this.text = text;
        this.type = type;
        this.opacity = opacity;
        
        
    }
    
    create(){

      if(this.type == "flower"){
        ctx.fillStyle = this.color;
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2+15, this.position.y+canvas.height/2-this.height/2, 15, 15);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2-15, this.position.y+canvas.height/2-this.height/2, 15, 15);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2, this.position.y+canvas.height/2-this.height/2+15, 15, 15);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2, this.position.y+canvas.height/2-this.height/2-15, 15, 15);
        ctx.globalAlpha = 0.5;
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2+10, this.position.y+canvas.height/2-this.height/2-10, 15, 15);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2-10, this.position.y+canvas.height/2-this.height/2-10, 15, 15);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2+10, this.position.y+canvas.height/2-this.height/2+10, 15, 15);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2-10, this.position.y+canvas.height/2-this.height/2+10, 15, 15);
        ctx.globalAlpha = 0.2;
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2+15, this.position.y+canvas.height/2-this.height/2+15, 15, 15);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2+15, this.position.y+canvas.height/2-this.height/2-15, 15, 15);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2-15, this.position.y+canvas.height/2-this.height/2-15, 15, 15);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2-15, this.position.y+canvas.height/2-this.height/2+15, 15, 15);
        ctx.globalAlpha = 1;
        ctx.fillStyle = "white";
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2, this.position.y+canvas.height/2-this.height/2, 15, 15);
        
      } else if (this.type == "tree") {
        ctx.fillStyle = this.color;
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2+40, this.position.y+canvas.height/2-this.height/2, 40, 40);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2-40, this.position.y+canvas.height/2-this.height/2, 40, 40);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2, this.position.y+canvas.height/2-this.height/2+40, 40, 40);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2, this.position.y+canvas.height/2-this.height/2-40, 40, 40);
        ctx.globalAlpha = 0.8;
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2+30, this.position.y+canvas.height/2-this.height/2-30, 40, 40);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2-30, this.position.y+canvas.height/2-this.height/2-30, 40, 40);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2+30, this.position.y+canvas.height/2-this.height/2+30, 40, 40);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2-30, this.position.y+canvas.height/2-this.height/2+30, 40, 40);
        ctx.globalAlpha = 0.5;
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2+40, this.position.y+canvas.height/2-this.height/2+40, 40, 40);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2+40, this.position.y+canvas.height/2-this.height/2-40, 40, 40);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2-40, this.position.y+canvas.height/2-this.height/2-40, 40, 40);
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2-40, this.position.y+canvas.height/2-this.height/2+40, 40, 40);
        ctx.globalAlpha = 1;
        ctx.fillStyle = "#7f550d";
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2, this.position.y+canvas.height/2-this.height/2, 40, 40);
        ctx.globalAlpha = .3;
        ctx.fillStyle = this.color;
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2, this.position.y+canvas.height/2-this.height/2, 40, 40);
        ctx.globalAlpha = 1;
      } else {
        ctx.globalAlpha = this.opacity;
        ctx.fillStyle = this.color;
        ctx.fillRect(this.position.x + canvas.width/2-this.width/2, this.position.y+canvas.height/2-this.height/2, this.width, this.height);
        ctx.globalAlpha = 1;
      }
      //7f550d tree brwn
    
}
}

var inside = new Element({x:0, y:0, width:2000, height:2000, color:"#2d0043", type:"inside"});
var outside = new Element({x:0, y:0, width:5000, height:5000, color:"#edd9af", opacity:.7, type:"outside"});
var elements = [new Element({x:0, y:0, width: 80, height:80, color:"#88c0f7", opacity:0.8, type:"spawn"}), new Element({x:-1000, y:0, width: 20, height:2000, color:"white", type:"border"}), new Element({x:0, y:-1000, width: 2000, height:20, color:"white", type:"border"}), new Element({x:1000, y:0, width: 20, height:2000, color:"white", type:"border"}), new Element({x:0, y:1000, width: 2000, height:20, color:"white", type:"border"}),new Element({x:1000, color:"green", y:-200, type:"tree"}),new Element({x:-550, color:"green", y:100, type:"tree"}),new Element({x:-300, color:"green", y:-700, type:"tree"}),new Element({x:-87, color:"green", y:876, type:"tree"}),new Element({x:890, color:"green", y:560, type:"tree"}),new Element({x:124, color:"#9518e2", y:-243, type:"tree"}),new Element({x:324, color:"#9518e2", y:543, type:"tree"}),new Element({x:-624, color:"#9518e2", y:743, type:"tree"})];
var flowers = [new Element({x:300, y:250, color:"blue", type:"flower"}),new Element({x:170, y:270, color:"red", type:"flower"}),new Element({x:-200, y:-500, color:"blue", type:"flower"}),new Element({x:-300, y:250, color:"purple", type:"flower"}),new Element({x:-259, y:-259, color:"blue", type:"flower"}),new Element({x:-700, y:-605, color:"yellow", type:"flower"}),new Element({x:700, y:567, color:"purple", type:"flower"}),new Element({x:-787, y:457, color:"yellow", type:"flower"}),new Element({x:650, y:-432, color:"yellow", type:"flower"}),new Element({x:-100, y:532, color:"yellow", type:"flower"}),new Element({x:134, y:732, color:"purple", type:"flower"}), new Element({x:456, y:-732, color:"yellow", type:"flower"})];
  class Player{
        constructor({x,y,color, username, type}){
          this.position = {
            x:x,
            y:y,
          }
          this.velocity = {
            x:0,
            y:0,
          }
          this.type=type;
          this.midair = true;
          this.width = 50;
          this.height= 50;
          this.leftEdge = false;
          this.rightEdge = false;
          this.color = color;
          this.disconnectTimer = 0;
          this.prevX = 0;
          this.prevY = 0;
          this.prevXRel = 0;
          this.prevYRel = 0;
          this.prevR = 0;
          this.username = username;
          this.message = "";
          this.messageTimer = 0;
          this.afkSymbol = "";
          this.afkColor = "white";
          this.rotation = 0;
          this.attacking = false;
          this.globalX = 0;
          this.globalY = 0;
          this.offset = 50;
          this.killed = false;
          this.spawncooldown = 90;
          this.atkCooldown = 0;
        
        }
        create(){
          if(this.type=="sniper"){
            this.offset = 300;
          }
          var shield = 0;
          var offset = 0;
          if (this.attacking) {
            offset = this.offset;
            shield = 35;
          } 
          if (this.username == username){
            if(this.type=="swordsman"){

          ctx.save();
          ctx.translate(canvas.width/2, canvas.height/2);


          


          ctx.rotate(this.rotation * Math.PI/180);


          ctx.beginPath();
          ctx.strokeStyle = "white";
          ctx.arc(0, 0, 40+ offset + shield, 0, 2 * Math.PI);
          ctx.stroke();




          ctx.fillStyle = this.color;
          ctx.fillRect(this.width/-2,this.height/-2,this.width,this.height);
          ctx.fillStyle = "#24e010";
        
        
        ctx.strokeStyle= "#ACABB3";
          ctx.lineWidth = 5;
          ctx.beginPath();
          ctx.moveTo(0+offset/2,0+offset/2);
          //ctx.moveTo(25,25);
          ctx.lineTo(25+offset,25+offset);
          ctx.stroke();
          ctx.beginPath();
          //ctx.moveTo(-25,25);
          ctx.moveTo(0+offset/-2,0+offset/2);
          ctx.lineTo(-25-offset,25+offset);
          ctx.stroke();
          ctx.beginPath();
          //ctx.moveTo(25,-25);
          ctx.moveTo(0+offset/2,0+offset/-2);
          ctx.lineTo(25+offset,-25-offset);
          ctx.stroke();
          ctx.beginPath();
          //ctx.moveTo(-25,-25);
          ctx.moveTo(0+offset/-2,0+offset/-2);
          ctx.lineTo(-25-offset,-25-offset);
          ctx.stroke();
        
        
        
          ctx.beginPath();
          // ctx.moveTo(25+offset,25+offset);
          // ctx.lineTo(50+offset,25+offset);
          // ctx.lineTo(25+offset,50+offset);
          
          ctx.moveTo(25+offset,25+offset);
          ctx.lineTo(0+offset+offset,25+offset);
          ctx.lineTo(25+offset,0+offset+offset);
          
          
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(-25-offset,25+offset);
          ctx.lineTo(-0-offset-offset,25+offset);
          ctx.lineTo(-25-offset,0+offset+offset);
          // ctx.moveTo(-25-offset,25+offset);
          // ctx.lineTo(-50-offset,-25+offset+offset);
          // ctx.lineTo(-25-offset,-25+offset+offset);
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(25+offset,-25-offset);
          ctx.lineTo(0+offset+offset,-25-offset);
          ctx.lineTo(25+offset,0-offset-offset);
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(-25-offset,-25-offset);
          ctx.lineTo(-offset-offset,-25-offset);
          ctx.lineTo(-25-offset,-offset-offset);
          ctx.fill();
          
          if(!this.attacking){
            ctx.fillStyle="white";
          ctx.fillRect(-5,-5,10,10);
          }
          
          
          


          
          ctx.restore();
          
                   
          ctx.fillStyle = this.afkColor;
          ctx.font = "25px Ubuntu";
          ctx.textAlign = "center";
          ctx.fillText(this.afkSymbol + this.afkSymbol + this.username + this.afkSymbol + this.afkSymbol,canvas.width/2, canvas.height/2-40);
          ctx.fillStyle = "white";
          ctx.font = "30px Ubuntu";
          ctx.textAlign = "center";
          ctx.fillText(this.message,canvas.width/2, canvas.height/2-75);
          



















            } else if(this.type == "sniper"){


















              ctx.save();
          ctx.translate(canvas.width/2, canvas.height/2);


          


          ctx.rotate(this.rotation * Math.PI/180);


          ctx.beginPath();
            ctx.strokeStyle = "white";
            ctx.globalAlpha = .3;

          ctx.arc(0, 0, 375, 0, 2 * Math.PI);
          ctx.stroke();
          ctx.globalAlpha=1;


          if(this.attacking){
            ctx.beginPath();
            ctx.strokeStyle = "white";
          ctx.arc(0, 0, 40+ offset + shield, 0, 2 * Math.PI);
          ctx.stroke();
          
          
} 
  offset = 0;

          




          ctx.fillStyle = this.color;
          ctx.fillRect(this.width/-2,this.height/-2,this.width,this.height);
          ctx.fillStyle = "black";
          ctx.strokeStyle= "#ACABB3";
          ctx.lineWidth = 5;
          ctx.beginPath();
          ctx.moveTo(0+offset/2,0+offset/2);
          //ctx.moveTo(25,25);
          ctx.lineTo(25+offset,25+offset);
          ctx.stroke();
          ctx.beginPath();
          //ctx.moveTo(-25,25);
          ctx.moveTo(0+offset/-2,0+offset/2);
          ctx.lineTo(-25-offset,25+offset);
          ctx.stroke();
          ctx.beginPath();
          //ctx.moveTo(25,-25);
          ctx.moveTo(0+offset/2,0+offset/-2);
          ctx.lineTo(25+offset,-25-offset);
          ctx.stroke();
          ctx.beginPath();
          //ctx.moveTo(-25,-25);
          ctx.moveTo(0+offset/-2,0+offset/-2);
          ctx.lineTo(-25-offset,-25-offset);
          ctx.stroke();
        
        
        
          ctx.beginPath();
          // ctx.moveTo(25+offset,25+offset);
          // ctx.lineTo(50+offset,25+offset);
          // ctx.lineTo(25+offset,50+offset);
          
          ctx.moveTo(25+offset,25+offset);
          ctx.lineTo(0+offset+offset,25+offset);
          ctx.lineTo(25+offset,0+offset+offset);
          
          
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(-25-offset,25+offset);
          ctx.lineTo(-0-offset-offset,25+offset);
          ctx.lineTo(-25-offset,0+offset+offset);
          // ctx.moveTo(-25-offset,25+offset);
          // ctx.lineTo(-50-offset,-25+offset+offset);
          // ctx.lineTo(-25-offset,-25+offset+offset);
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(25+offset,-25-offset);
          ctx.lineTo(0+offset+offset,-25-offset);
          ctx.lineTo(25+offset,0-offset-offset);
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(-25-offset,-25-offset);
          ctx.lineTo(-offset-offset,-25-offset);
          ctx.lineTo(-25-offset,-offset-offset);
          ctx.fill();
            ctx.fillStyle="black";
          ctx.fillRect(-5,-5,10,10);
          
          ctx.restore();
          
          ctx.globalAlpha = .5;
          ctx.fillStyle = this.afkColor;
          ctx.font = "25px Ubuntu";
          ctx.textAlign = "center";
          ctx.fillText(this.afkSymbol + this.afkSymbol + this.username + this.afkSymbol + this.afkSymbol,canvas.width/2, canvas.height/2-40);
          ctx.globalAlpha = 1;
          ctx.fillStyle = "white";
          ctx.font = "30px Ubuntu";
          ctx.textAlign = "center";
          ctx.fillText(this.message,canvas.width/2, canvas.height/2-75);
            }
















          } else {
          if(this.type=="swordsman"){
            var posX = this.width/-2;
          var posY = this.height/-2;
          // this.position.x -= players[username].position.x;
          // this.position.y -= players[username].position.y;
          ctx.save();
          ctx.translate(this.position.x+canvas.width/2, this.position.y+canvas.height/2);
          ctx.rotate(this.rotation * Math.PI/180);
          ctx.beginPath();
          ctx.strokeStyle = "white";
          ctx.arc(0, 0, 40+ offset + shield, 0, 2 * Math.PI);
          ctx.stroke();
          
          //fillText([text], [x], [y]); [confirmed]
          ctx.fillStyle = this.color;
          ctx.fillRect(posX,posY,this.width,this.height);
          ctx.fillStyle = "#24e010"; //changecolor
          
        ctx.strokeStyle= "#ACABB3";
          ctx.lineWidth = 5;
          ctx.beginPath();
          ctx.moveTo(0+offset/2,0+offset/2);
          //ctx.moveTo(25,25);
          ctx.lineTo(25+offset,25+offset);
          ctx.stroke();
          ctx.beginPath();
          //ctx.moveTo(-25,25);
          ctx.moveTo(0+offset/-2,0+offset/2);
          ctx.lineTo(-25-offset,25+offset);
          ctx.stroke();
          ctx.beginPath();
          //ctx.moveTo(25,-25);
          ctx.moveTo(0+offset/2,0+offset/-2);
          ctx.lineTo(25+offset,-25-offset);
          ctx.stroke();
          ctx.beginPath();
          //ctx.moveTo(-25,-25);
          ctx.moveTo(0+offset/-2,0+offset/-2);
          ctx.lineTo(-25-offset,-25-offset);
          ctx.stroke();
        
        
        
          ctx.beginPath();
          // ctx.moveTo(25+offset,25+offset);
          // ctx.lineTo(50+offset,25+offset);
          // ctx.lineTo(25+offset,50+offset);
          
          ctx.moveTo(25+offset,25+offset);
          ctx.lineTo(0+offset+offset,25+offset);
          ctx.lineTo(25+offset,0+offset+offset);
          
          
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(-25-offset,25+offset);
          ctx.lineTo(-0-offset-offset,25+offset);
          ctx.lineTo(-25-offset,0+offset+offset);
          // ctx.moveTo(-25-offset,25+offset);
          // ctx.lineTo(-50-offset,-25+offset+offset);
          // ctx.lineTo(-25-offset,-25+offset+offset);
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(25+offset,-25-offset);
          ctx.lineTo(0+offset+offset,-25-offset);
          ctx.lineTo(25+offset,0-offset-offset);
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(-25-offset,-25-offset);
          ctx.lineTo(-offset-offset,-25-offset);
          ctx.lineTo(-25-offset,-offset-offset);
          ctx.fill();
          
          if(!this.attacking){
            ctx.fillStyle="white";
          ctx.fillRect(-5,-5,10,10);
          }
          
          
          
          ctx.restore();
          
          
          ctx.fillStyle = this.afkColor;
          ctx.font = "25px Ubuntu";
          ctx.textAlign = "center";
          ctx.fillText(this.afkSymbol + this.afkSymbol + this.username + this.afkSymbol + this.afkSymbol,this.position.x+canvas.width/2, this.position.y+canvas.height/2-40);
          ctx.fillStyle = "white";
          ctx.font = "30px Ubuntu";
          ctx.textAlign = "center";
          ctx.fillText(this.message,this.position.x+canvas.width/2, this.position.y+canvas.height/2-75);
          

          }  else if(this.type == "sniper"){
            
          




            var posX = this.width/-2;
          var posY = this.height/-2;
          // this.position.x -= players[username].position.x;
          // this.position.y -= players[username].position.y;
          ctx.save();
          ctx.translate(this.position.x+canvas.width/2, this.position.y+canvas.height/2);
          ctx.rotate(this.rotation * Math.PI/180);
          ctx.beginPath();
            ctx.strokeStyle = "white";
            ctx.globalAlpha = 0;

          ctx.arc(0, 0, 375, 0, 2 * Math.PI);
          ctx.stroke();
          ctx.globalAlpha=1;


          if(this.attacking){
            ctx.beginPath();
            ctx.strokeStyle = "white";
          ctx.arc(0, 0, 40+ offset + shield, 0, 2 * Math.PI);
          ctx.stroke();
          
          
} 
  offset = 0;

          




          ctx.fillStyle = this.color;
          ctx.fillRect(posX,posY,this.width,this.height);
          ctx.fillStyle = "black";
          ctx.strokeStyle= "#ACABB3";
          ctx.lineWidth = 5;
          ctx.beginPath();
          ctx.moveTo(0+offset/2,0+offset/2);
          //ctx.moveTo(25,25);
          ctx.lineTo(25+offset,25+offset);
          ctx.stroke();
          ctx.beginPath();
          //ctx.moveTo(-25,25);
          ctx.moveTo(0+offset/-2,0+offset/2);
          ctx.lineTo(-25-offset,25+offset);
          ctx.stroke();
          ctx.beginPath();
          //ctx.moveTo(25,-25);
          ctx.moveTo(0+offset/2,0+offset/-2);
          ctx.lineTo(25+offset,-25-offset);
          ctx.stroke();
          ctx.beginPath();
          //ctx.moveTo(-25,-25);
          ctx.moveTo(0+offset/-2,0+offset/-2);
          ctx.lineTo(-25-offset,-25-offset);
          ctx.stroke();
        
        
        
          ctx.beginPath();
          // ctx.moveTo(25+offset,25+offset);
          // ctx.lineTo(50+offset,25+offset);
          // ctx.lineTo(25+offset,50+offset);
          
          ctx.moveTo(25+offset,25+offset);
          ctx.lineTo(0+offset+offset,25+offset);
          ctx.lineTo(25+offset,0+offset+offset);
          
          
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(-25-offset,25+offset);
          ctx.lineTo(-0-offset-offset,25+offset);
          ctx.lineTo(-25-offset,0+offset+offset);
          // ctx.moveTo(-25-offset,25+offset);
          // ctx.lineTo(-50-offset,-25+offset+offset);
          // ctx.lineTo(-25-offset,-25+offset+offset);
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(25+offset,-25-offset);
          ctx.lineTo(0+offset+offset,-25-offset);
          ctx.lineTo(25+offset,0-offset-offset);
          ctx.fill();
          ctx.beginPath();
          ctx.moveTo(-25-offset,-25-offset);
          ctx.lineTo(-offset-offset,-25-offset);
          ctx.lineTo(-25-offset,-offset-offset);
          ctx.fill();
            ctx.fillStyle="black";
          ctx.fillRect(-5,-5,10,10);
          
          ctx.restore();
          
          
          ctx.fillStyle = this.afkColor;
          ctx.font = "25px Ubuntu";
          ctx.textAlign = "center";
          ctx.fillText(this.afkSymbol + this.afkSymbol + this.username + this.afkSymbol + this.afkSymbol,this.position.x+canvas.width/2, this.position.y+canvas.height/2-40);
          ctx.fillStyle = "white";
          ctx.font = "30px Ubuntu";
          ctx.textAlign = "center";
          ctx.fillText(this.message,this.position.x+canvas.width/2, this.position.y+canvas.height/2-75);
}











          
          }
        }

      }
      const movement = {
        right: false,
        left: false,
        up: false,
        down: false,
        atk: false,
      }

      var fps = 45;
      var heightVal = 1152;
      var widthVal = 2048;
      var prevWidth;
      var prevHeight;
      function maxZoomOut(){
        widthVal = 2048;
        heightVal = 1152;
      }
      function bigZoom(){
        widthVal = 4000;
        heightVal = 2250;
      }
      function animate(){
      
    setTimeout(function() {
      
      
      
      
      
      
      
      
      // if(username=="LeftClickMage"){
      //         document.body.appendChild(kickButton);

      // }
      
    
      
     
      if(started){
        if (innerWidth/innerHeight >= .75){
          maxZoomOut();
        }
        var prop = innerHeight/innerWidth;
      
      if (innerWidth*9/16 != innerHeight){
        heightVal = widthVal*prop;

      }
      if (heightVal>1152){
        var difference = heightVal-1152;
        var varHeight = heightVal;
        var varWidth = widthVal;
        for(let i = difference; i > 0; i--){
          varHeight -= 1*prop;
          varWidth -= 1;
        }
        widthVal = varWidth;
        heightVal = varHeight;
      }
      } else {
        if (innerWidth/innerHeight >= .75){
          bigZoom();
        }
        var prop = innerHeight/innerWidth;
      
      if (innerWidth*9/16 != innerHeight){
        heightVal = widthVal*prop;

      }
      if (heightVal>2250){
        var difference = heightVal-2250;
        var varHeight = heightVal;
        var varWidth = widthVal;
        for(let i = difference; i > 0; i--){
          varHeight -= 1*prop;
          varWidth -= 1;
        }
        widthVal = varWidth;
        heightVal = varHeight;
      }
      }
      canvas.width = widthVal;
      canvas.height = heightVal;

      if (chatInput.value == "/"){
        chatInput.value = "";
      }
      ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
        requestAnimationFrame(animate);
        if(started){
          
          players[username].spawncooldown -= 1;

          var speedModifier = 1;

          if (movement.up && movement.right){
            speedModifier = .7;
          } else if (movement.up && movement.left){
            speedModifier = .7;
          } else if (movement.down && movement.left){
            speedModifier = .7;
          } else if (movement.down && movement.right){
            speedModifier = .7;
          }
          if (players[username].attacking && players[username].type=="swordsman"){
            speedModifier += .2;
          }
          if (players[username].offset>=15 && players[username].offset < 40 && players[username].type=="swordsman"){
speedModifier-=.1;
          }else if (players[username].offset>2 && players[username].offset < 15 && players[username].type=="swordsman"){
  speedModifier =.6;

} else if (players[username].offset <=2 && players[username].type=="swordsman") {
  speedModifier =.2;

}
if(players[username].type == "swordsman"){
if (players[username].offset>40){
  document.getElementById('stamBadge').setAttribute("class", "badge bg-success");
} else if (players[username].offset>15){
  document.getElementById('stamBadge').setAttribute("class", "badge bg-warning");
} else if (players[username].offset>2){
  document.getElementById('stamBadge').setAttribute("class", "badge bg-danger");
} else {
  document.getElementById('stamBadge').setAttribute("class", "badge bg-dark");
  
}
document.getElementById('stamBadge').innerHTML = players[username].offset*2;
        }
if(players[username].atkCooldown > 0 && players[username].type=="sniper"){
          speedModifier=.6
}
if(!players[username].attacking && players[username].type=="sniper"){
            if(players[username].atkCooldown > 0){
              players[username].atkCooldown-=1;
            } else {
              document.getElementById("atkCooldownBadge").setAttribute("class", "badge bg-success");
              document.getElementById("atkCooldownBadge").innerHTML = "Ready!";
              speedModifier += .3
              
            }
          } else if(players[username].attacking && players[username].type=="sniper") {
            players[username].atkCooldown=100;
            document.getElementById("atkCooldownBadge").innerHTML = "Reloading..";
            document.getElementById("atkCooldownBadge").setAttribute("class", "badge bg-secondary");
          }
          if (movement.right && players[username].rightEdge == false){
          players[username].globalX += 10*speedModifier;
          players[username].velocity.x = 10 * speedModifier;
        } else if (movement.left && players[username].leftEdge == false){
          players[username].globalX += -10*speedModifier;
          players[username].velocity.x = -10 * speedModifier;
        } else {
          players[username].velocity.x = 0 * speedModifier;
        }
        if (movement.up){
          players[username].globalY += -10 * speedModifier;
          players[username].velocity.y = -10 * speedModifier;
        } else if (movement.down){
          players[username].globalY += 10 * speedModifier;
          players[username].velocity.y = 10 * speedModifier;
        } else {
          players[username].velocity.y = 0 * speedModifier;
        }
        if(movement.atk){
          if(players[username].type=="sniper"){
            if(players[username].atkCooldown == 0){
              players[username].attacking = true;
            } else {
              players[username].attacking = false;
            }
          }else {
            players[username].attacking = true;
          }
          
        } else {
          players[username].attacking = false;
        }
        if(players[username].attacking){
          players[username].rotation += 4;
        } else {
          players[username].rotation += 2.6;
        }
        
        if((players[username].position.x>=980 && movement.right) || (players[username].position.x <=-980 && movement.left)){
          players[username].velocity.x = 0;
          socket.emit('update', username, 'killed'); 
          players[username].killed = true; 
                usernameList.splice(usernameList.indexOf(username), 1);
        }
        if((players[username].position.y>=980 && movement.down) || (players[username].position.y <=-980 && movement.up)){
          players[username].velocity.y = 0;
          socket.emit('update', username, 'killed'); 
          players[username].killed = true; 
                usernameList.splice(usernameList.indexOf(username), 1);
        }
        

        players[username].position.x += players[username].velocity.x;
        players[username].position.y += players[username].velocity.y;


        outside.position.x -= players[username].velocity.x;
        outside.position.y -= players[username].velocity.y;
        outside.create();
        inside.position.x -= players[username].velocity.x;
        inside.position.y -= players[username].velocity.y;
        inside.create();
        if (spawned){
          for(let i = 0; i<flowers.length; i++){
          flowers[i].position.x -= players[username].velocity.x;
          flowers[i].position.y -= players[username].velocity.y;
          flowers[i].create();
        }
      }
      players[username].create();
      socket.emit('move', username, [players[username].position.x, players[username].globalX, players[username].offset, players[username].spawncooldown, players[username].type],[players[username].position.y, players[username].globalY], players[username].rotation, players[username].attacking);


      for(let i = 0; i<usernameList.length; i++){
    

          if(usernameList[i] != username){
        if (players[username].position.x != players[username].prevXRel||players[username].position.y != players[username].prevYRel){
                          if (players[usernameList[i]].position.x == players[usernameList[i]].prevXRel && players[usernameList[i]].position.y == players[usernameList[i]].prevYRel){
                            players[usernameList[i]].position.x -= players[username].velocity.x;
                            players[usernameList[i]].position.y -= players[username].velocity.y;
                          }

}
}




       

          
          if(players[usernameList[i]].spawncooldown>0){
            players[usernameList[i]].color = "yellow";
            players[usernameList[i]].spawncooldown -= 1;
          } else {
          if (usernameList[i] == username){
            players[usernameList[i]].color = "blue";
          } else {
            players[usernameList[i]].color = "red";
            
          }
        }
          
          if (players[usernameList[i]].prevX == players[usernameList[i]].globalX && players[usernameList[i]].prevY == players[usernameList[i]].globalY){
            players[usernameList[i]].disconnectTimer +=1;
          } else {
            players[usernameList[i]].disconnectTimer = 0;
            players[usernameList[i]].afkSymbol = "";
              players[usernameList[i]].afkColor = "white";
              
          }
          if(players[usernameList[i]].messageTimer >= 200){
            players[usernameList[i]].message = "";
            players[usernameList[i]].messageTimer = 0;
            socket.emit('update', usernameList[i], "msg<prog>msg</prog>msgpassword:password:msg")
          } else {
            players[usernameList[i]].messageTimer += 1;
          }
          
          if(players[usernameList[i]].attacking == true ){
            if(players[usernameList[i]].offset> 0){
              players[usernameList[i]].offset -= .5;
            } 
            
          } else {
            if(players[usernameList[i]].offset<50){
              players[usernameList[i]].offset += .5;
            }
          }
          
          
         // socket.emit('update', usernameList[i], ["offsetUpdate", players[usernameList[i]].offset]);
          //2200 , 2700
          if (players[usernameList[i]].disconnectTimer == 2200){
              players[usernameList[i]].afkSymbol = "*";
              players[usernameList[i]].afkColor = "red";
              socket.emit('update', usernameList[i], "red<prog>red</prog>dcpassword:password:dc");
          } else if (players[usernameList[i]].disconnectTimer == 2700){
            var user = usernameList[i];
              usernameList.splice(usernameList.indexOf(usernameList[i]), 1);
              socket.emit('update', user, "dc<prog>dc</prog>dcpassword:password:dc");
              
          }
          if (players[usernameList[i]].rotation == players[usernameList[i]].prevR && usernameList[i] != username){
            if (players[usernameList[i]].attacking){
              players[usernameList[i]].rotation +=4;
              
            
            } else {
              players[usernameList[i]].rotation +=2.6;
              
            }
            
          
          }
          
          



          //END. PUT YOUR CODE ABOVE UNLESS IZZ TEST!
          if(usernameList[i] != username){
            // console.log(players[usernameList[i]].position.x == players[username].position.x + 100);
          // 
          var distX = players[username].globalX - players[usernameList[i]].globalX;
          var distY = players[username].globalY - players[usernameList[i]].globalY;
          var dist = Math.sqrt(distX*distX + distY*distY);

            if(players[username].attacking==true && dist > players[username].offset+45 && dist < players[username].offset+105){
              
              if(players[usernameList[i]].spawncooldown < 0 && players[username].spawncooldown<0){
                socket.emit('update', usernameList[i], 'killed'); 
                players[usernameList[i]].killed = true; 
                usernameList.splice(usernameList.indexOf(usernameList[i]), 1);
              }
            } 














            players[usernameList[i]].prevXRel = players[usernameList[i]].position.x;
          players[usernameList[i]].prevYRel = players[usernameList[i]].position.y;
          players[usernameList[i]].prevX = players[usernameList[i]].globalX;
          players[usernameList[i]].prevY = players[usernameList[i]].globalY;
          players[usernameList[i]].prevR = players[usernameList[i]].rotation;



            if(!players[usernameList[i]].killed){
              players[usernameList[i]].create();
            }
          
          }
           
          
          
          
        }
    
        

        
       
      
        } else {
        outside.create();
        inside.create();
          for(let i = 0; i<flowers.length; i++){
          flowers[i].create();
        
        }
      }
      if(started){
          for(let i = 0; i<elements.length; i++){
        elements[i].position.x -= players[username].velocity.x;
        elements[i].position.y -= players[username].velocity.y;
        elements[i].create();
        }
        } else {
          for(let i = 0; i<elements.length; i++){
        elements[i].create();
        }
      }

    }, 1000 / fps);
        
        
        }
      

    //ctx.translate(x+width.2, y+height/2);
    //ctx,rotate(degrees*Math.PI/180);
    
    



socket.on('move', function(user, valX, valY, valR,atk){


  
  var inGame = false;
  for(let i = 0; i<usernameList.length; i++){
   
    // console.log(usernameList[i]+":"+players[usernameList[i]].position.x);
    if (user == usernameList[i]) {
      inGame = true;
    }
  }
  if (players[user] == undefined){
    spawnPlayerManual(user, valX[4]);
    
  }
  if (!inGame){
    usernameList.push(user);
    
  }
  if(user != username){
    players[user].position.x = valX[0] - players[username].position.x;
    players[user].position.y = valY[0] - players[username].position.y;
    players[user].rotation = valR;
    players[user].attacking = atk;
    players[user].globalX = valX[1];
    players[user].globalY = valY[1];
    players[user].offset = valX[2];
    players[user].spawncooldown = valX[3];
    players[user].type = valX[4];
  }
  usernameList = usernameList.filter(function(item, index, inputArray){
    return inputArray.indexOf(item) == index;
  });

   
        
        

});
socket.on('disconnect', function(){
  socket.emit('update', username);
  
});
socket.on('update', function(user, msg){
 if (msg == "dc<prog>dc</prog>dcpassword:password:dc"){
   usernameList.splice(usernameList.indexOf(user), 1);
   if(username == user){
     location.reload();
   }
    
   
  } //else if(msg[0] == "offsetUpdate"){
//     players[user].offset = msg[1];
//    }
    else if (msg == "msg<prog>msg</prog>msgpassword:password:msg") {
    players[user].message = "";
    players[user].messageTimer = 0;
  } else if (msg == "red<prog>red</prog>dcpassword:password:dc") {
    players[user].afkSymbol = "*";
    players[user].afkColor = "red";
  } else if(msg == "killed"){
  usernameList.splice(usernameList.indexOf(user), 1);
  if(username == user){
    usernameList = [""];
    players = [""];
    document.body.removeChild(document.getElementById('canvas'));
    var boxLarge = document.createElement("div");
    boxLarge.setAttribute("class", "d-flex position-fixed top-0 align-items-center bg-dark");
    boxLarge.setAttribute("style", "z-index:1000000; min-height:100vh;min-width:100vw;");
    var box = document.createElement("div");
    box.setAttribute("class", "container text-center");
    
    var button = document.createElement("button");
    button.setAttribute("class", "btn btn-info fs-2");
    button.innerHTML = "Play Again?";
    button.setAttribute("onclick", "location.reload()");
    box.appendChild(button);
    boxLarge.appendChild(box);
    document.body.appendChild(boxLarge);
   }
   } else {
   players[user].messageTimer= 0;
   players[user].message = msg;
 }
  
 


});
socket.on('spawn player', function(user) {
  console.log(spawned);
  if (!spawned && user[0] != ""){
    players[user[0]] = new Player({x:0, y:0, color:"yellow", username:user[0], type:user[1]});
    spawned = true;
  } else {
    players[user[0]] = new Player({x:0, y:0, color:"yellow", username:user[0], type:user[1]});
  }
  usernameList.push(user[0]);

  if(user[0] == username){
    started=true;
  }


});
function spawnPlayerManual(user, type) {
  console.log("created");
  players[user] = new Player({x:0, y:0, color:"yellow", username:user, type:type});
  usernameList.push(user);
}
function checkOverflow(element) {
  var curOverflow = element.style.overflow;
  if(!curOverflow || curOverflow === "visible") {
    element.style.overflow = "hidden";
  }
  var isOverflowing = element.clientWidth < element.scrollHeight*1.9969;
  element.style.overflow = curOverflow;
  return isOverflowing;
}

var playerData = [];
function signUp(){
  var usernames = document.getElementById('usernameValue').value;
  var passwords = document.getElementById('passwordValue').value;
  if(usernames.trim().length==0 || passwords.trim().length==0 ){
    alert("You need to type something!")
  } else {
    fetch('/login', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({"username" : usernames, "password" : passwords})})
  .then(function(response) {
      if(response.ok) return response.json();
      throw new Error('Request failed.');
    })
    .then(function(data) {
     if(data.length!=0){
      alert("Username Taken!");
     } else {
      var dataCon={
        "username": usernames,
        "password": passwords
      };
      setLoginData(dataCon);
     }
   
    })
    .catch(function(error) {
      console.log(error);
    });
  }
  
}
function loginFetch(username, password){
  document.getElementById('logButton').setAttribute("onclick", "");
  fetch('/userpost', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({"user" : username})})
.then(function(response) {
      if(response.ok) return response.json();
      throw new Error('Request failed.');
    });
    fetch('/passpost', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({"pass" : password})})
.then(function(response) {
      if(response.ok) return response.json();
      throw new Error('Request failed.');
    });
  fetch('/login', {method: 'GET'})
    .then(function(response) {
      if(response.ok) return response.json();
      throw new Error('Request failed.');
    })
    .then(function(data) {
      console.log(data);
      if(data){
        document.getElementById('logButton').setAttribute("onclick", "login()");
         var dataCon={
        "username": username,
        "password": password
      };
      setLoginData(dataCon);
        
      } else {
         
        alert("Incorrect username or password!");
        location.reload()
        
      }
    })
    .catch(function(error) {
      console.log(error);
    });
}
function login(){
  var usernamesd = document.getElementById('usernameValue').value;
  var password = document.getElementById('passwordValue').value;
  if(usernamesd.trim().length==0 || password.trim().length==0 ){
    alert("You need to type something!")
  } else {
  loginFetch(usernamesd, password);
  }
}
var holder = document.getElementById('loginHolder');
var logsign = document.getElementById('noAccBox');
var logout = document.getElementById('logOutBox');

function checkLogIn() {
  let cookieData = getCookie("player-data");
  if (cookieData.length !== 0) {

   setLoginData(JSON.parse(cookieData));

  }
}
checkLogIn();
function setLoginData(data){
  if(beginDiv.contains(credHolder)){
    beginDiv.removeChild(credHolder);
  }
  playerData = data;
  document.getElementById('profileName').innerHTML = playerData["username"];
  setCookie("player-data", JSON.stringify(playerData));
  holder.appendChild(logout);
        
        holder.removeChild(logsign);
}
console.log(playerData);
if(playerData.length == 0){
        holder.removeChild(logout);
      } else {
        holder.removeChild(logsign);
      }

      function logoutACC(){
        playerData = [];
        setCookie("player-data", "");
        document.getElementById('profileName').innerHTML = "Guest";
        location.reload();
      }
  </script>
  
  
  

  </body>
</html>

